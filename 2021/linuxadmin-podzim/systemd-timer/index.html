<div class="admonition warning"><p>Tohle jsou jen velice strohé poznámky, ne materiály k samostudiu.</p>
</div><h1>Systemd jednotky</h1>
<p>Opakování</p>
<ul>
<li><code>systemctl status sshd</code></li>
<li><code>systemctl stop sshd</code></li>
<li><code>systemctl start sshd</code></li>
<li><code>systemctl restart sshd</code></li>
<li><code>systemctl cat sshd</code></li>
</ul>
<p>Nastavení systemd</p>
<ul>
<li><code>/usr/lib/systemd/system/</code></li>
<li><code>/usr/lib/systemd/system/sshd.service</code></li>
<li><code>/etc/systemd/system/</code> – pro administrátora</li>
<li>symlinky na <code>/dev/null</code></li>
</ul>
<p>Typy „units“:</p>
<p><code>ls /usr/lib/systemd/system/ | cut -d. -f2</code></p>
<ul>
<li><code>service</code></li>
<li><code>target</code></li>
<li><code>socket</code></li>
<li><code>timer</code></li>
<li><code>mount</code></li>
<li>...</li>
</ul>
<p>Použití plného jména:</p>
<ul>
<li><code>systemctl status sshd.service</code></li>
<li><code>systemctl status graphical.target</code></li>
<li><code>systemctl cat sshd.service</code></li>
<li><code>systemctl cat sshd.socket</code></li>
</ul>
<p>(Odbočka k <em>socket</em>?)</p>
<ul>
<li><code>systemctl cat graphical.target</code></li>
</ul>
<p>Závislosti:</p>
<ul>
<li><code>systemctl list-dependencies sshd</code></li>
<li><code>systemctl list-dependencies graphical.target</code></li>
</ul>
<p>Dokumentace:</p>
<ul>
<li><code>man systemd.service</code>, ...</li>
<li><code>man systemd.service</code>, <code>man systemd.mount</code></li>
</ul>
<h2>Timer</h2>
<ul>
<li><code>man systemd.timer</code></li>
<li><code>man systemd.time</code></li>
<li><code>man systemd.unit</code></li>
</ul>
<h2>Naše služba</h2>
<p><code>/etc/systemd/system/ahoj.service</code>:</p>
<div class="highlight"><pre><code>[Unit]
Description=echo

[Service]
Type=oneshot
ExecStart=/usr/bin/echo Ahoj!</code></pre></div><ul>
<li><code>sudo systemctl daemon-reload</code></li>
<li><code>sudo systemctl start ahoj.service</code></li>
<li><code>sudo systemctl status ahoj.service</code></li>
</ul>
<p><code>/etc/systemd/system/ahoj.timer</code>:</p>
<div class="highlight"><pre><code>[Unit]
Description=echo timer

[Timer]
OnCalendar=*-*-* *:*:00/10
AccuracySec=1s
Unit=ahoj.service</code></pre></div><ul>
<li><code>sudo systemctl daemon-reload</code></li>
<li><code>sudo systemctl start ahoj.timer</code></li>
<li><code>sudo systemctl status ahoj.service</code> (!)</li>
</ul>
<h2>Uživatelská služba &amp; časovač</h2>
<div class="highlight"><pre><code>mkdir -p ~/.config/systemd/user/</code></pre></div><p><code>~/.config/systemd/user/gong.service</code>:</p>
<div class="highlight"><pre><code>[Unit]
Description=Gong

[Service]
Type=oneshot
ExecStart=/usr/bin/mplayer /usr/share/sounds/gnome/default/alerts/sonar.ogg</code></pre></div><p><code>~/.config/systemd/user/gong.timer</code>:</p>
<div class="highlight"><pre><code>[Unit]
Description=Gong

[Timer]
OnCalendar=*-*-* *:*:00/10
AccuracySec=1s
Unit=gong.service</code></pre></div>