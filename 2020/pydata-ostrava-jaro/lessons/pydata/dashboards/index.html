<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1>Interaktivn√≠ vizualizace a aplikace</h1>
<p>P≈ôi pr√°ci s daty je mnoho p≈ô√≠le≈æitost√≠, kdy se hod√≠ interaktivita. P≈ôi vizualici se hod√≠ zvƒõt≈°ov√°n√≠ / zmƒõn≈°ov√°n√≠ mƒõ≈ô√≠tka, v√Ωbƒõr podoblasti, uk√°z√°n√≠ vykreslen√Ωch hodnot apod. Nebo p≈ôi datov√© anl√Ωze obecnƒõ se m≈Ø≈æe hodit interaktivnƒõ v notebooku mƒõnit nƒõjak√Ω parametr (t≈ôeba hyperparametr pro strojov√© uƒçen√≠). Anebo chceme d√°t v√Ωsledky na≈°√≠ skvƒõl√© anal√Ωzy k dispozici "netechnick√Ωm" koleg≈Øm nebo kamar√°d≈Øm, kte≈ô√≠ (zat√≠m) nedok√°≈æ√≠ Jupyter notebook spustit.</p>
<p>Tady si uk√°≈æeme, jak si s takov√Ωmi √∫koly poradit pomoc√≠ dvou n√°stroj≈Ø: <a href="https://plotly.com/python/">plotly</a>, resp. p≈ôedev≈°√≠m <a href="https://plotly.com/python/plotly-express/">plotly express</a>, a <a href="https://panel.holoviz.org/">panel</a>.</p>
<p>Existuj√≠ i dal≈°√≠ n√°stroje, kter√© poskytuj√≠ podobn√© mo≈ænosti. Podrobn√Ω p≈ôehled najdete na <a href="https://pyviz.org/tools.html">https://pyviz.org/tools.html</a>.  Na interaktivn√≠ vizualizace jsou to p≈ôedev≈°√≠m <a href="http://github.com/pyviz/holoviews">holoviews</a> nebo <a href="http://github.com/altair-viz/altair">altair</a>. Na "dashboarding" pak <a href="http://github.com/plotly/dash">dash</a>, <a href="http://github.com/streamlit/streamlit">streamlit</a>, <a href="http://github.com/QuantStack/voila">voila</a> nebo <a href="https://justpy.io">justpy</a>.</p>
<p>Ka≈æd√Ω z tƒõchto n√°stroj≈Ø m√°, jako obvykle, sv√© v√Ωhody a nev√Ωhody. Nejroz≈°√≠≈ôenƒõj≈°√≠m n√°strojem je <a href="http://github.com/plotly/dash">Dash</a> ze stejn√© d√≠lny jako plotly, kter√Ω poskytuje i enterprise ≈ôe≈°en√≠ pro provoz aplikac√≠. Dash je urƒçitƒõ dobrou volbou, jak se m≈Ø≈æete dozvƒõdƒõt i na <a href="https://www.youtube.com/watch?v=dewrzMPPLDU">p≈ôedn√°≈°ce z pra≈æsk√©ho PyData Meetupu</a>. Panel (a tak√© Voila) se od Dash li≈°√≠ t√≠m, ≈æe je lze pou≈æ√≠t i v Jupytere notebooku a pak notebook pou≈æ√≠t p≈ô√≠mo jako aplikaci - a proto Panel pou≈æijeme my v t√©to lekci.</p>
<p>P√°r ƒçl√°nk≈Ø ƒçi p≈ôedn√°≈°ek, kter√© se t√©matu t√Ωkaj√≠:</p>
<ul>
<li><a href="https://www.intelligencerefinery.io/post/making-python-apps/">Going beyond Jupyter notebooks</a></li>
<li><a href="https://towardsdatascience.com/how-to-build-a-complex-reporting-dashboard-using-dash-and-plotl-4f4257c18a7f">How to Build a Reporting Dashboard using Dash and Plotly</a></li>
<li><a href="https://www.youtube.com/watch?v=L91rd1D6XTA">Turn any Notebook into a Deployable Dashboard | SciPy 2019 | James Bednar</a></li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2>Pro a proti</h2>
<p>Je pot≈ôeba ale ≈ô√≠ct, ≈æe v≈°echny tyto p≈ô√≠stupy maj√≠ sv√© v√Ωrazn√© nev√Ωhody a limity a nehod√≠ se pro velk√© a slo≈æit√© aplikace. Mo≈ænosti interakc√≠ v aplikaci jsou omezen√© a tak√© mohou b√Ωt pomal√©. Robustn√≠ ≈°k√°lov√°n√≠ pro mnoho u≈æivatel≈Ø (velk√Ω provoz) je obecnƒõ slo≈æitƒõj≈°√≠. Kdy tedy p≈ôedev≈°√≠m pou≈æ√≠t co si tady uk√°≈æeme?</p>
<ul>
<li>Na malou aplikaci pro omezen√Ω poƒçet u≈æivatel≈Ø (dashboard pro kolegy).</li>
<li>Na rychl√Ω v√Ωvoj prototypu.</li>
</ul>
<p>A co kdy≈æ chceme budovat velkou (webovou) aplikaci?</p>
<ul>
<li>Zad√°me v√Ωvoj√°≈ôsk√©mu t√Ωmu, aby v modern√≠ch JavaScript n√°stroj√≠ch typu React nebo Vue.js pro n√°s vytvo≈ôil kr√°sn√Ω a rychl√Ω "front-end", zat√≠mco my vytvo≈ô√≠me v Pythonu "back-end", kter√Ω s front-endem bude komunikovat nap≈ô. pomoc√≠ JSON API, tak jak jsme vidƒõli v <a href="naucse:page?lesson=pydata/api">na≈°√≠ lekci o API</a>.</li>
<li>Kdy≈æ takov√Ω t√Ωm nem√°me, nauƒç√≠me se programovat JavaScriptu ... Ne, radƒõji v TypeScriptu ...</li>
<li>... radƒõji najmeme ten v√Ωvoj√°≈ôsk√Ω t√Ωm :-)</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2>Instalace a import grafick√Ωch knihoven</h2>
<p>Pokud nem√°te nainstalovan√© knihovny plotly a panel, odkomentujte a spus≈•e p≈ô√≠slu≈°n√© ≈ô√°dky.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># instalace plotly</span>
<span class="c1"># %pip install plotly</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># instalace panel</span>
<span class="c1"># POZOR: nainstalujte tuto (v dobƒõ vzniku nejnovƒõj≈°√≠) verzi, </span>
<span class="c1"># s nƒõkter√Ωmi p≈ôede≈°l√Ωmi verzemi byl probl√©m v n√°slen√©m provozu na heroku</span>

<span class="c1"># %pip install bokeh==2.0.2 panel==0.9.5</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Pro plotly express a panel se v≈æily zkratky <code>px</code> a <code>pn</code>, pod kter√Ωmi je naimportujeme i my. 
D√°le je pro pou≈æit√≠ panelu v notebooku pot≈ôeba zavolat <code>pn.extension</code>, v na≈°em p≈ô√≠padƒõ s argumentem <code>"plotly"</code> aby tyto dvƒõ knihovny spr√°vnƒõ spolupracovaly.
Je doporuƒçen√© to udƒõlat hned na zaƒç√°tku notebooku, resp. p≈ôed pou≈æit√≠m plotly nebo panel, jinak m≈Ø≈æe doj√≠t k probl√©m≈Øm v zobrazov√°n√≠ notebooku.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span>
<span class="kn">import</span> <span class="nn">panel</span> <span class="k">as</span> <span class="nn">pn</span>

<span class="n">pn</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="s2">&quot;plotly&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2>COVID-19 dashboard</h2>
<p>Z onemocnƒõn√≠ COVID-19 je v dobƒõ vzniku tohoto kurzu vƒõt≈°ina z n√°s u≈æ dost ne≈°≈•astn√°. Poskytuje ale p≈ô√≠le≈æitost k anal√Ωz√°m dat a vytv√°≈ôen√≠ vizualizac√≠ a dashboard≈Ø. Jejich p≈ôehled a hodnocen√≠ p≈ôin√°≈°√≠ nap≈ô. i ƒçl√°nek z MIT: <a href="https://www.technologyreview.com/2020/03/06/905436/best-worst-coronavirus-dashboards/">The best, and the worst, of the coronavirus dashboards</a>. Uvid√≠me, jestli se do p≈ô√≠≈°t√≠ho vyd√°n√≠ dostane a n√°≈° dashboard :)</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>Data</h3>
<p>Pou≈æijeme data z <a href="https://github.com/datasets/covid-19">https://github.com/datasets/covid-19</a> (lehce p≈ôeform√°tovan√° data z Johns Hopkins University: <a href="https://github.com/CSSEGISandData/COVID-19">https://github.com/CSSEGISandData/COVID-19</a>).</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">covid_data_raw</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
    <span class="s2">&quot;https://raw.githubusercontent.com/datasets/covid-19/master/data/time-series-19-covid-combined.csv&quot;</span><span class="p">,</span>
    <span class="n">parse_dates</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Date&quot;</span><span class="p">],</span>
<span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Province/State&quot;</span><span class="p">:</span> <span class="s2">&quot;State&quot;</span><span class="p">,</span> <span class="s2">&quot;Country/Region&quot;</span><span class="p">:</span> <span class="s2">&quot;Country&quot;</span><span class="p">})</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">covid_data_raw</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[6]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Country</th>
      <th>State</th>
      <th>Lat</th>
      <th>Long</th>
      <th>Confirmed</th>
      <th>Recovered</th>
      <th>Deaths</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2020-01-22</td>
      <td>Afghanistan</td>
      <td>NaN</td>
      <td>33.0</td>
      <td>65.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2020-01-23</td>
      <td>Afghanistan</td>
      <td>NaN</td>
      <td>33.0</td>
      <td>65.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2020-01-24</td>
      <td>Afghanistan</td>
      <td>NaN</td>
      <td>33.0</td>
      <td>65.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2020-01-25</td>
      <td>Afghanistan</td>
      <td>NaN</td>
      <td>33.0</td>
      <td>65.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2020-01-26</td>
      <td>Afghanistan</td>
      <td>NaN</td>
      <td>33.0</td>
      <td>65.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>28989</th>
      <td>2020-05-05</td>
      <td>Zimbabwe</td>
      <td>NaN</td>
      <td>-20.0</td>
      <td>30.0</td>
      <td>34.0</td>
      <td>5.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>28990</th>
      <td>2020-05-06</td>
      <td>Zimbabwe</td>
      <td>NaN</td>
      <td>-20.0</td>
      <td>30.0</td>
      <td>34.0</td>
      <td>5.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>28991</th>
      <td>2020-05-07</td>
      <td>Zimbabwe</td>
      <td>NaN</td>
      <td>-20.0</td>
      <td>30.0</td>
      <td>34.0</td>
      <td>5.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>28992</th>
      <td>2020-05-08</td>
      <td>Zimbabwe</td>
      <td>NaN</td>
      <td>-20.0</td>
      <td>30.0</td>
      <td>34.0</td>
      <td>9.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>28993</th>
      <td>2020-05-09</td>
      <td>Zimbabwe</td>
      <td>NaN</td>
      <td>-20.0</td>
      <td>30.0</td>
      <td>35.0</td>
      <td>9.0</td>
      <td>4.0</td>
    </tr>
  </tbody>
</table>
<p>28994 rows √ó 8 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Pro nƒõkter√© zemƒõ je v datech v√≠ce region≈Ø. My si ale data agregujeme podle zem√≠ dohromady.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">covid_data</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">covid_data_raw</span>
    <span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;Country&quot;</span><span class="p">,</span> <span class="s2">&quot;Date&quot;</span><span class="p">])[[</span><span class="s2">&quot;Confirmed&quot;</span><span class="p">,</span> <span class="s2">&quot;Recovered&quot;</span><span class="p">,</span> <span class="s2">&quot;Deaths&quot;</span><span class="p">]]</span>
    <span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="s2">&quot;sum&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="p">)</span>
<span class="n">covid_data</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[7]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Country</th>
      <th>Date</th>
      <th>Confirmed</th>
      <th>Recovered</th>
      <th>Deaths</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Afghanistan</td>
      <td>2020-01-22</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Afghanistan</td>
      <td>2020-01-23</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Afghanistan</td>
      <td>2020-01-24</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Afghanistan</td>
      <td>2020-01-25</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Afghanistan</td>
      <td>2020-01-26</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>20378</th>
      <td>Zimbabwe</td>
      <td>2020-05-05</td>
      <td>34.0</td>
      <td>5.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>20379</th>
      <td>Zimbabwe</td>
      <td>2020-05-06</td>
      <td>34.0</td>
      <td>5.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>20380</th>
      <td>Zimbabwe</td>
      <td>2020-05-07</td>
      <td>34.0</td>
      <td>5.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>20381</th>
      <td>Zimbabwe</td>
      <td>2020-05-08</td>
      <td>34.0</td>
      <td>9.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>20382</th>
      <td>Zimbabwe</td>
      <td>2020-05-09</td>
      <td>35.0</td>
      <td>9.0</td>
      <td>4.0</td>
    </tr>
  </tbody>
</table>
<p>20383 rows √ó 5 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>Interaktivn√≠ vizualizace</h3>
<p>Zaj√≠m√° n√°s pr≈Øbƒõh jedn√© konkr√©tn√≠ zemƒõ - t≈ôeba ƒåeska :)</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># ulo≈æ√≠me si to do promƒõnn√©, abychom to pak nespletli</span>
<span class="n">country</span> <span class="o">=</span> <span class="s2">&quot;Czechia&quot;</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">covid_selected_country</span> <span class="o">=</span> <span class="n">covid_data</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Country == &quot;</span><span class="si">{country}</span><span class="s1">&quot;&#39;</span><span class="p">)</span>
<span class="n">covid_selected_country</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[9]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Country</th>
      <th>Date</th>
      <th>Confirmed</th>
      <th>Recovered</th>
      <th>Deaths</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>5118</th>
      <td>Czechia</td>
      <td>2020-05-05</td>
      <td>7896.0</td>
      <td>4006.0</td>
      <td>257.0</td>
    </tr>
    <tr>
      <th>5119</th>
      <td>Czechia</td>
      <td>2020-05-06</td>
      <td>7974.0</td>
      <td>4205.0</td>
      <td>262.0</td>
    </tr>
    <tr>
      <th>5120</th>
      <td>Czechia</td>
      <td>2020-05-07</td>
      <td>8031.0</td>
      <td>4371.0</td>
      <td>270.0</td>
    </tr>
    <tr>
      <th>5121</th>
      <td>Czechia</td>
      <td>2020-05-08</td>
      <td>8077.0</td>
      <td>4413.0</td>
      <td>273.0</td>
    </tr>
    <tr>
      <th>5122</th>
      <td>Czechia</td>
      <td>2020-05-09</td>
      <td>8095.0</td>
      <td>4447.0</td>
      <td>276.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Urƒçitƒõ bude zaj√≠mav√© si data vykreslit v grafu. Zat√≠m jsme pou≈æ√≠vali hlavnƒõ knihovnu <code>matplotlib</code>. Ta toho um√≠ opravdu hodnƒõ, nav√≠c jde pou≈æ√≠vat p≈ô√≠mo pomoc√≠ <code>DataFrame.plot</code>. Chyb√≠ j√≠ ale vlastnost, kter√° je pro datovou anal√Ωzu a hlavnƒõ pak pro webov√© aplikace nesm√≠rnƒõ u≈æiteƒçn√°: <em>interaktivita</em>. (Ona tedy nechyb√≠ √∫plnƒõ, ale je velmi omezen√°.)</p>
<p>Interaktivita n√°m umo≈æ≈àuje bohat≈°√≠ pr√°ci s vizualizacemi. M≈Ø≈æeme si zvƒõt≈°it nƒõjakou podoblast grafu. M≈Ø≈æeme zvƒõt≈°ovat / zmen≈°ovat mƒõ≈ô√≠tko aby byly vidƒõt t≈ôeba i mal√© rozd√≠ly v hodnot√°ch. V <a href="naucse:page?lesson=pydata/pca">lekci a PCA</a> jsme pou≈æili interakticn√≠ popisky jednotliv√Ωch symbol≈Ø v grafu na identifikaci p≈ô√≠slu≈°n√©ho z√°znamu v datech. A mnoho dal≈°√≠ho.</p>
<p>S <a href="https://plot.ly">plotly</a>, resp. <a href="https://plotly.com/python/plotly-express/">plotly-express</a>, u≈æ jsme trochu pracovali. Pojƒème tedy tuto knihovnu rovnou pou≈æ√≠t!</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">px</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span>
    <span class="n">covid_selected_country</span><span class="p">,</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;Date&quot;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;Confirmed&quot;</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="n">f</span><span class="s2">&quot;Confirmed cases in </span><span class="si">{country}</span><span class="s2">&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Teƒè byste mƒõli v notebooku vidƒõt graf - v√Ωvoj p≈ô√≠pad≈Ø v ƒåesku. Pojƒème si s grafem chvilku hr√°t :)</p>
<p><strong>Vyzkou≈°ejte:</strong></p>
<ul>
<li>Vybrat a vyzkou≈°et n√°stroje v prav√©m horn√≠m rohu na zoom (zmƒõnu mƒõ≈ô√≠tka), pan (posun) nebo reset axis.</li>
<li>Zkuste se zastavit s kurzorem nad jedn√≠m ze slopc≈Ø v grafu.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>√ökol:</strong></p>
<ol>
<li>Vykreslete pr≈Øbƒõh poƒçtu naka≈æen√Ωch pro ƒåesko, Rakousko a Finsko v jednom grafu, ka≈ædou zemi jinou barvou (pou≈æijte argument <code>color</code>). Na filtrov√°n√≠ dat si vzpome≈àte na <code>.isin</code>. </li>
<li>Zmƒõ≈àte veliƒçinu na poƒçet uzdraven√Ωch.</li>
<li>Zmƒõ≈àte typ grafu na ƒç√°rov√Ω (line).</li>
</ol>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Dok√°zali jsme si vytvo≈ôit celkem pƒõknou vizualizaci z√°kladn√≠ch veliƒçin, popisuj√≠ch pr≈Øbƒõh pandemie COVID-19. Museli jsme si ale ruƒçnƒõ vyb√≠rat a p≈ôep√≠nat parametry vizualizace, nap≈ô. v√Ωbƒõr zem√≠ nebo vykreslovan√© veliƒçiny.</p>
<p>Praktiƒçtƒõj≈°√≠ by urƒçitƒõ bylo m√≠t nƒõjak√© "klik√°tko" - "vyb√≠r√°v√°tko", kter√© by n√°m parametry umo≈ænilo nastavit.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>Widgets - pomocn√© "vƒõciƒçky"</h3>
<p>V u≈æivatelsk√Ωch grafick√Ωch rozhran√≠ch (GUI), zejm√©na tƒõch pou≈æ√≠vaj√≠c√≠ch webov√© technologie, se pr√°vƒõ pro tyto p≈ôile≈æitosti hod√≠ <em>widgety</em> (ƒçesk√Ω v√Ωraz se nepou≈æ√≠v√° a ani po≈ô√°dnƒõ neexistuje).</p>
<p>A jeliko≈æ m√°me to ≈°tƒõst√≠, ≈æe notebook m√° webov√© grafick√© rozhran√≠, m≈Ø≈æeme widgety p≈ôidat p≈ô√≠mo do nƒõj. Jednou z mo≈ænost√≠ je pou≈æ√≠t knihovnu <a href="https://panel.pyviz.org">panel</a>.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Vytvo≈ô√≠me si rovnou √∫plnƒõ jednoduch√Ω widget na v√Ωbƒõr zƒõmƒõ:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[11]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">country_selection</span> <span class="o">=</span> <span class="n">pn</span><span class="o">.</span><span class="n">widgets</span><span class="o">.</span><span class="n">Select</span><span class="p">(</span><span class="n">options</span><span class="o">=</span><span class="nb">sorted</span><span class="p">(</span><span class="n">covid_data</span><span class="p">[</span><span class="s2">&quot;Country&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Country&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A teƒè si ho zobraz√≠me p≈ô√≠ho v notebooku:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">country_selection</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>V tuto chv√≠li m≈Ø≈æete vyb√≠rat se zeznamu v≈°ech zem√≠, kter√© jsou v na≈°ich datech. To je pohled v√°s jako u≈æivatele. Ale co se stane z pohledu program√°tora, tedy co se stane v Pythonu?</p>
<p>Objekt <code>country_selection</code> n√°m nab√≠z√≠ nƒõkolik atribut≈Ø a metod, kter√© n√°m umo≈æ≈àuj√≠ zjistit, co u≈æivatel udƒõlal. V tomto p≈ô√≠padƒõ se nejv√≠c hod√≠ zjistit, jakou zemi u≈æivatel vybral. A na to je <code>.value</code>.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[13]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">country_selection</span><span class="o">.</span><span class="n">value</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[13]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&#39;Afghanistan&#39;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>√ökol:</strong> Vyberte v bu≈àce naho≈ôe svou (ne)obl√≠benou zemi a pod√≠vejte se, jestli se zmƒõnila hodnota <code>country_selection.value</code>. Je pot≈ôeba spou≈°tƒõ znovu bu≈àku, kter√° zobrazuje <code>country_selection</code> widget? Co se stane, kdy≈æ j√≠ spust√≠te znovu (t≈ôeba v jin√© bu≈àce)?</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>country_selection.value</code> u≈æ je nƒõco, co m≈Ø≈æeme pou≈æ√≠t pro vykreslen√≠ grafu podobnƒõ jako p≈ôed chvilkou:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">px</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span>
    <span class="n">covid_data</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Country == &quot;</span><span class="si">{country_selection.value}</span><span class="s1">&quot;&#39;</span><span class="p">),</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;Date&quot;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;Confirmed&quot;</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="n">f</span><span class="s2">&quot;Confirmed cases in </span><span class="si">{country_selection.value}</span><span class="s2">&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Teƒè jsme mohli vybrat jeden parametr. Hodilo by se n√°m ale vyb√≠rat v√≠ce parametr≈Ø r≈Øzn√Ωch typ≈Ø: v√Ωbƒõr v√≠ce zem√≠, vykreslen√° veliƒçina, p≈ôep√≠naƒç logaritmick√© ≈°k√°ly nebo t≈ôeba typ zobrazen√≠ (bar nebo line plot). S volbou vhodn√Ωch widget≈Ø n√°m pom≈Ø≈æe <a href="https://panel.holoviz.org/reference/index.html">dokumentace panel</a> (pozor, nƒõkter√© widgety nejsou v na≈°√≠ star≈°√≠ verzi dostupn√©). Abychom nemuseli ka≈æd√Ω widget zobrazovat zvl√°≈°≈•, pou≈æijeme komponenty z kategorie Layouts, nyn√≠ konkr√©tnƒõ <code>Column</code>.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[15]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># widget pro v√Ωbƒõr v√≠ce mo≈ænost√≠ ze seznamu</span>
<span class="n">countries_selection</span> <span class="o">=</span> <span class="n">pn</span><span class="o">.</span><span class="n">widgets</span><span class="o">.</span><span class="n">CrossSelector</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Countries&quot;</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="nb">sorted</span><span class="p">(</span><span class="n">covid_data</span><span class="p">[</span><span class="s2">&quot;Country&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()),</span> <span class="n">value</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Czechia&quot;</span><span class="p">]</span>
<span class="p">)</span>
<span class="c1"># v√Ωbƒõr vykreslen√© veliƒçiny</span>
<span class="n">plotted_variable</span> <span class="o">=</span> <span class="n">pn</span><span class="o">.</span><span class="n">widgets</span><span class="o">.</span><span class="n">Select</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Plotted variable&quot;</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Confirmed&quot;</span><span class="p">,</span> <span class="s2">&quot;Recovered&quot;</span><span class="p">,</span> <span class="s2">&quot;Deaths&quot;</span><span class="p">]</span>
<span class="p">)</span>
<span class="c1"># p≈ôep√≠naƒç logaritmick√© ≈°k√°ly</span>
<span class="n">use_log_scale</span> <span class="o">=</span> <span class="n">pn</span><span class="o">.</span><span class="n">widgets</span><span class="o">.</span><span class="n">Checkbox</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Use log scale&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="c1"># v√Ωbƒõr typu grafu</span>
<span class="n">plot_type</span> <span class="o">=</span> <span class="n">pn</span><span class="o">.</span><span class="n">widgets</span><span class="o">.</span><span class="n">Select</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Plot type&quot;</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;bar&quot;</span><span class="p">:</span> <span class="n">px</span><span class="o">.</span><span class="n">bar</span><span class="p">,</span> <span class="s2">&quot;line&quot;</span><span class="p">:</span> <span class="n">px</span><span class="o">.</span><span class="n">line</span><span class="p">}</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A teƒè to d√°me v≈°e dohromady pro zobrazen√≠ nad sebou, tj. do sloupce, a rovnou zobraz√≠me.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">selections</span> <span class="o">=</span> <span class="n">pn</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">countries_selection</span><span class="p">,</span> <span class="n">plotted_variable</span><span class="p">,</span> <span class="n">use_log_scale</span><span class="p">,</span> <span class="n">plot_type</span><span class="p">)</span>

<span class="n">selections</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Pokud chceme d√°t dvƒõ komponenty vedle sebe, d√°me je do jedn√© ≈ôady nebo <code>Row</code>:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">selections</span> <span class="o">=</span> <span class="n">pn</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span>
    <span class="n">countries_selection</span><span class="p">,</span> <span class="n">pn</span><span class="o">.</span><span class="n">Row</span><span class="p">(</span><span class="n">plotted_variable</span><span class="p">,</span> <span class="n">plot_type</span><span class="p">),</span> <span class="n">use_log_scale</span>
<span class="p">)</span>

<span class="n">selections</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A teƒè u≈æ m≈Ø≈æeme vybran√© mo≈ænosti pou≈æ√≠t:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plot_type</span><span class="o">.</span><span class="n">value</span><span class="p">(</span>
    <span class="n">covid_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">covid_data</span><span class="p">[</span><span class="s2">&quot;Country&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">countries_selection</span><span class="o">.</span><span class="n">value</span><span class="p">)],</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;Date&quot;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="n">plotted_variable</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;Country&quot;</span><span class="p">,</span>
    <span class="n">log_y</span><span class="o">=</span><span class="n">use_log_scale</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>Prov√°z√°n√≠ u≈æivatelsk√Ωch vstup≈Ø a v√Ωstupu</h3>
<p>Na≈°√≠ aplikaci teƒè chyb√≠ u≈æ jen "maliƒçkost" - prov√°zat u≈æivatelsk√© vstupy s v√Ωstupem tak, aby se v√Ωstup automaticky aktualizoval. 
Aby se n√°m to poda≈ôilo, budeme muset n√°≈° k√≥d zabalit do funkce, kter√° aplikaci (dashboard) vytv√°≈ô√≠.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[19]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># argumenty funkce NEJSOU widgety</span>
<span class="k">def</span> <span class="nf">create_dashboard</span><span class="p">(</span><span class="n">countries</span><span class="p">,</span> <span class="n">plot_variable</span><span class="p">,</span> <span class="n">plot_function</span><span class="p">,</span> <span class="n">log_y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">plot_type</span><span class="o">.</span><span class="n">value</span><span class="p">(</span>
        <span class="n">covid_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">covid_data</span><span class="p">[</span><span class="s2">&quot;Country&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">countries</span><span class="p">)],</span>
        <span class="n">x</span><span class="o">=</span><span class="s2">&quot;Date&quot;</span><span class="p">,</span>
        <span class="n">y</span><span class="o">=</span><span class="n">plot_variable</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;Country&quot;</span><span class="p">,</span>
        <span class="n">log_y</span><span class="o">=</span><span class="n">log_y</span><span class="p">,</span>
    <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Funkci m≈Ø≈æeme vyzkou≈°et a p≈ôedat j√≠ aktu√°ln√≠ hodnoty z widget≈Ø. T√≠m ale st√°le je≈°tƒõ <em>nem√°me interaktivn√≠ aplikaci</em>.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">create_dashboard</span><span class="p">(</span>
    <span class="n">countries</span><span class="o">=</span><span class="n">countries_selection</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
    <span class="n">plot_variable</span><span class="o">=</span><span class="n">plotted_variable</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
    <span class="n">plot_function</span><span class="o">=</span><span class="n">plot_type</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
    <span class="n">log_y</span><span class="o">=</span><span class="n">use_log_scale</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>T√≠m zb√Ωvaj√≠c√≠m kouskem skl√°daƒçky k interaktivn√≠ aplikaci je funkce <code>interact</code>. Ta n√°m "obal√≠" na≈°i funkci, v tomto p≈ô√≠padƒõ <code>create_dashboard</code>, a sv√°≈æe hodnoty widget≈Ø se vstupn√≠mi argumenty na≈°√≠ funkce (kter√° generuje grafick√Ω v√Ωstup na z√°kladƒõ hodnot vstupn√≠ch parametr≈Ø).</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[21]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># nejprve interaktivn√≠ dashboard vytvo≈ô√≠me</span>
<span class="n">interactive_dashboard</span> <span class="o">=</span> <span class="n">pn</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span>
    <span class="n">create_dashboard</span><span class="p">,</span>
    <span class="n">countries</span><span class="o">=</span><span class="n">countries_selection</span><span class="p">,</span>
    <span class="n">plot_variable</span><span class="o">=</span><span class="n">plotted_variable</span><span class="p">,</span>
    <span class="n">plot_function</span><span class="o">=</span><span class="n">plot_type</span><span class="p">,</span>
    <span class="n">log_y</span><span class="o">=</span><span class="n">use_log_scale</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># a pot√© zobraz√≠me</span>
<span class="n">interactive_dashboard</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Teƒè si zkuste mƒõnit hodnoty pomoc√≠ widget≈Ø - v√Ωstup se bude hned mƒõnit (tedy skoro hned - takto vytvo≈ôen√° aplikace nen√≠ nejsvi≈ænƒõj≈°√≠ - to je drob√° da≈à za jednoduchust implementace).</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2>Z notebooku k samostatn√© aplikaci</h2>
<p>Zat√≠m jsi si v≈°e zprovoznil(a) ve sv√©m notebooku. To je v√Ωborn√©, ale m√° to po≈ô√°d je≈°tƒõ drobnou nev√Ωhodu - poslat takov√Ω notebook nƒõkomu, kdo si pod pojmem Python vybav√≠ pouze üêç, je riskantn√≠. Kdy≈æ toti≈æ jako n√°povƒõdu usly≈°√≠, ≈æe si toho hada m√° pustit, nejsp√≠≈° se lekne a uteƒçe. M√≠sto toho bychom radƒõji p≈ôedali jen odkaz na webovou "str√°nku", tedy na n√°≈° dashboard.</p>
<p>Zaƒçneme t√≠m, ≈æe si aplikaci spust√≠me na sv√©m poƒç√≠taƒçi. To jde na≈°tƒõst√≠ velice jednodu≈°e, dokonce m≈Ø≈æeme pou≈æ√≠t p≈ô√≠mo tento notebook. Jen mus√≠me nƒõjak vysvƒõtlit, co p≈ôesnƒõ v t√© aplikaci m√° b√Ωt. Na to slou≈æ√≠ metoda <code>servable</code>.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">interactive_dashboard</span><span class="o">.</span><span class="n">servable</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;M≈Øj COVID-19 dashboard&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>V notebooku se nic nezmƒõnilo, m≈Ø≈æeme ale spustit notebook jako samostatnou aplikaci. V p≈ô√≠kazov√© ≈ô√°dce to zajist√≠</p>
<div class="highlight"><pre><code>bokeh serve dashboards.ipynb</code></pre></div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Zobraz√≠ se n√°m nƒõco jako</p>
<div class="highlight"><pre><code>2020-04-13 09:31:13,787 Starting Bokeh server version 1.4.0 (running on Tornado 6.0.4)
2020-04-13 09:31:13,799 User authentication hooks NOT provided (default user enabled)
2020-04-13 09:31:13,802 Bokeh app running at: http://localhost:5006/dashboards
2020-04-13 09:31:13,802 Starting Bokeh server with process id: 9220</code></pre></div><p>Na t≈ôet√≠m ≈ô√°dku jistƒõ rozezn√°te webov√Ω odkaz. Pravdƒõpodobnƒõ tam bude <a href="http://localhost:5006/dashboards">http://localhost:5006/dashboards</a>. Pokud tuto adresu otev≈ôe≈° v prohl√≠≈æeƒçi, zobraz√≠ se posledn√≠ verze na≈°eho COVID dashboardu - ta, u kter√© jsme zavolal metodu <code>.servable()</code>.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>Publikujeme na internet</h3>
<p>V principu bychom mohli spustit aplikaci u sebe na poƒç√≠taƒçi tak, aby ji mohli pou≈æ√≠vat i dal≈°√≠ u≈æivatel√©. Na vnit≈ôn√≠ s√≠ti (dom√°c√≠, pracovn√≠) by to bylo snadn√© (i kdy≈æ na pracovn√≠ s√≠ti a pracovn√≠m poƒç√≠taƒçi by tomu mohla br√°nit bezpeƒçnostn√≠ nastaven√≠), p≈ô√≠stup z vnƒõj≈°√≠ho internetu by u≈æ byl komplikovanƒõj≈°√≠.</p>
<p>Na≈°tƒõst√≠ nejsme v podobn√© situaci sami :) Tak≈æe existuj√≠ v√≠ce ƒçi m√©nƒõ slo≈æit√© a sofistikovan√© zp≈Øsoby, jak aplikaci spustit na nƒõjak√©m serveru (v cloudu) a zp≈ô√≠stupnit z internetu. My si uk√°≈æeme, jak to funguje na <a href="https://heroku.com">Heroku</a>. Podobn√© slu≈æby nab√≠z√≠ t≈ôeba AWS (Elastic Beanstalk), Google App Engine nebo Dokku on Digital Ocean. V√Ωhodou Heroku je jednoduchost a mo≈ænost bezplatn√Ωch slu≈æeb, nev√Ωhodou pak rychle rostouc√≠ cena a omezen√© mo≈ænosti.</p>
<p>Budeme postupovat v podstatƒõ podle pr≈Øvodce <a href="https://devcenter.heroku.com/articles/getting-started-with-python">Getting started with Python</a>.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>Registrace a klient Heroku</h3>
<p>Ne≈æ zaƒçneme, je pot≈ôeba:</p>
<ol>
<li>Zalo≈æit si bezplatn√Ω √∫ƒçet na <a href="https://signup.heroku.com/signup/dc">https://signup.heroku.com/signup/dc</a>.</li>
<li>Nainstalovat Git:<ul>
<li>Windows: <a href="https://gitforwindows.org/">https://gitforwindows.org/</a></li>
<li>Mac OS: <a href="https://sourceforge.net/projects/git-osx-installer/files/">https://sourceforge.net/projects/git-osx-installer/files/</a> (p≈ô√≠padnƒõ dal≈°√≠ mo≈ænosti popsan√© na <a href="https://www.atlassian.com/git/tutorials/install-git">https://www.atlassian.com/git/tutorials/install-git</a>).</li>
<li>Linux: Nejsp√≠≈° tam u≈æ bude nebo urƒçitƒõ v√≠≈° jak na to :)</li>
</ul>
</li>
<li>Alespo≈à z√°kladn√≠ konfigurace Gitu. V p≈ô√≠kazov√©m ≈ô√°dku (<em>vypl≈àte sv√© jm√©no a email</em>):<div class="highlight"><pre><code>git config --global user.name "Moje Jm√©no"
git config --global user.email "muj@email.com"</code></pre></div></li>
<li>Nainstalovat si Heroku klienta:<ul>
<li>Postupujte podle <a href="https://devcenter.heroku.com/articles/heroku-cli">https://devcenter.heroku.com/articles/heroku-cli</a></li>
</ul>
</li>
</ol>
<p>Instalaci ovƒõ≈ô√≠me v p≈ô√≠kazov√© ≈ô√°dce pomoc√≠:</p>
<ol>
<li><p>Git:</p>
<div class="highlight"><pre><code>git config --list</code></pre></div><p>Mƒõlo by se objevit nƒõco na zp≈Øsob</p>
<div class="highlight"><pre><code>user.name=Moje Jm√©no
user.email=muj@email.com</code></pre></div></li>
<li><p>Heroku:</p>
<div class="highlight"><pre><code>heroku --version</code></pre></div><p>Tady by mƒõlo b√Ωt v√Ωstupem zhruba</p>
<div class="highlight"><pre><code>heroku/7.39.2 darwin-x64 node-v12.13.0</code></pre></div></li>
</ol>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>Go-live</h3>
<p>Teƒè budeme chvilku pracovat v p≈ô√≠kazov√© ≈ô√°dce. Ne≈æ zaƒçnete ps√°t p≈ô√≠kazy, ujistƒõte se, ≈æe jste ve slo≈æce s t√≠mto netebookem. Ide√°lnƒõ by v t√©to slo≈æce mƒõl b√Ωt (zat√≠m) jen tento notebook. Pokud to tak nen√≠, m≈Ø≈æete si vytvo≈ôit slo≈æku novou a notebook tam p≈ôesunout nebo zkop√≠rovat.</p>
<p>A m≈Ø≈æeme zaƒç√≠t:</p>
<ol>
<li><p>Mus√≠me vytvo≈ôit Git repozit√°≈ô:</p>
<div class="highlight"><pre><code>git init</code></pre></div></li>
<li><p>Pro Heroku pot≈ôebuje vytvo≈ôit soubor s n√°zvem <code>Procfile</code>. Ten velice jednodu≈°e ≈ô√≠k√°, co ≈æe to vlastnƒõ chceme spustit. Bude tam p≈ô√≠kaz <code>bokeh serve</code> (tak jako jsme spou≈°tƒõli aplikaci lok√°lnƒõ) s p√°r p≈ôep√≠naƒçi nav√≠c. Konkr√©tnƒõ soubor <code>Procfile</code> mus√≠ obsahovat tento ≈ô√°dek:</p>
<div class="highlight"><pre><code>web: bokeh serve --port=$PORT --allow-websocket-origin="*" --address=0.0.0.0 dashboards.ipynb</code></pre></div></li>
<li><p>Dal≈°√≠m souborem, kter√Ω pot≈ôebujeme, je <code>requirements.txt</code>. O tom jste u≈æ mo≈æn√° sly≈°eli(y) - obsahuje seznam Python bal√≠ƒçk≈Ø, kter√© pot≈ôebuje dan√Ω Python projekt. Heroku tento soubor pou≈æije, aby p≈ôed spu≈°tƒõn√≠m aplikace nainstaloval v≈°e pot≈ôebn√©. Pro n√°≈° dashboard mus√≠ b√Ωv v <code>requirements.txt</code> toto:</p>
<div class="highlight"><pre><code>bokeh==2.0.2
panel==0.9.5
pandas==1.0.3
notebook==6.0.3
plotly==4.5.4</code></pre></div></li>
<li><p>Soubory u≈æ m√°me p≈ôipraven√©, pot≈ôebujeme je teƒè p≈ôidat do Git repozit√°≈ôe. Na to pou≈æij tyto dva p≈ô√≠kazy:</p>
<div class="highlight"><pre><code>git add dashboards.ipynb Procfile requirements.txt
git commit -v -m "prvn√≠ verze dashboardu"</code></pre></div></li>
<li><p>A teƒè u≈æ m≈Ø≈æeme publikovat. Tedy nejd≈ô√≠ve se p≈ôihl√°sit pomoc√≠</p>
<div class="highlight"><pre><code>heroku login</code></pre></div><p>(Postupujte dle pokyn≈Ø - otev≈ôe se p≈ôihla≈°ovac√≠ str√°nka ve webov√©m prohl√≠≈æeƒçi, kter√° v√°s vyzve k zad√°n√≠ p≈ôihla≈°ovac√≠ch √∫daj≈Ø.)</p>
</li>
<li><p>Pak je≈°tƒõ vytvo≈ôit Heroku aplikaci pomoc√≠</p>
<div class="highlight"><pre><code>heroku create</code></pre></div></li>
<li><p>A nakonec u≈æ opravdu vypustit aplikaci na internet pomoc√≠</p>
<div class="highlight"><pre><code>git push heroku master</code></pre></div></li>
</ol>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Pokud v≈°e p≈Øjde dob≈ôe, tento krok bude chv√≠li trvat. Postupnƒõ se bude vypisovat, co pro n√°s Heroku dƒõl√°:</p>
<div class="highlight"><pre><code>Enumerating objects: 7, done.
Counting objects: 100% (7/7), done.
Delta compression using up to 4 threads
Compressing objects: 100% (4/4), done.
Writing objects: 100% (4/4), 940.72 KiB | 2.40 MiB/s, done.
Total 4 (delta 2), reused 0 (delta 0)
remote: Compressing source files... done.
remote: Building source:
remote:
remote: -----&gt; Python app detected
remote: -----&gt; Clearing cached dependencies
remote: -----&gt; Installing python-3.8.2
remote: -----&gt; Installing pip
remote: -----&gt; Installing SQLite3
remote: Sqlite3 successfully installed.
remote: -----&gt; Installing requirements with pip
remote:        Collecting bokeh==1.4.0
remote:          Downloading bokeh-1.4.0.tar.gz (32.4 MB)
remote:        Collecting panel==0.8.3
...</code></pre></div><p>Nakonec by se mƒõlo objevit nƒõco jako</p>
<div class="highlight"><pre><code>remote: -----&gt; Launching...
remote:        Released v20
remote:        https://banana-sundae-72768.herokuapp.com/ deployed to Heroku
remote:
remote: Verifying deploy... done.
To https://git.heroku.com/banana-sundae-72768.git
   2652f01..8d65612  master -&gt; master</code></pre></div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>D≈Øle≈æit√Ω je odkaz pod ≈ô√°dkem "Released v20". To je toti≈æ adresa, na kter√© je n√°≈° dashboard dostupn√Ω "odkudkoli z internetu". Buƒè si ji zkop√≠rujte do prohl√≠≈æeƒçe nebo pou≈æijte p≈ô√≠kaz <code>heroku open</code>.</p>
</div>
</div>
</div>
 

